{
  "hash": "c1d446a55b4254e017d5484d342f80d7",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lecture 16 - ANCOVA \"\nauthor: \"Bill Perry\"\nexecute:\n  freeze: auto\n  cache: true\n  echo: true\n  keep-md: true\n  message: false\n  warning: false\n  fig-height: 5\n  fig-width: 4\n  paged-print: false\nformat:\n  html:\n    toc: false\n    output-file: \"16_01_lecture_powerpoint_html.html\"\n    embed-resources: true\n    self-contained: true\n    max-width: 80ch\n    css: ../../css/lecture.css\n  revealjs:\n    output-file: \"16_01_lecture_powerpoint_slides.html\"\n    self-contained: true\n    css: ../../css/lecture.css\n    slide-number: true\n    transition: fade\n  docx:\n    default: true\n    toc: false\n    toc-depth: 3\n    number-sections: true\n    highlight-style: github\n    reference-doc: ../../ms_templates/custom-reference.docx\n    css: msword.css\n    embed-resources: true\n  pptx:\n    reference-doc: ../../ms_templates/lecture_template.pptx \n    embed-resources: true\neditor: visual\n---\n\n\n\n\n\n\n\n\n# Lecture 15: Review\n\n::::: columns\n::: {.column width=\"60%\"}\n## **Review**\n\n-   \n\n    ## General linearized models (GLM\n:::\n\n::: {.column width=\"40%\"}\n\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n\n:::\n:::::\n\n# Lecture 16: Overview\n\n## Overview\n\nAnalysis of covariance (ANCOVA):\n\n-   Introduction to ANCOVA\n-   When to use ANCOVA\n-   Linear model for ANCOVA\n-   Analysis of variance in ANCOVA\n-   Assumptions of ANCOVA\n    -   Homogeneous slopes\n-   Robust ANCOVA approaches\n-   Specific comparisons of means\n-   Examples and interpretation\n-   Scientific reporting of ANCOVA results\n\n# **Lecture 16:** Introduction to ANCOVA\n\n::::: columns\n::: {.column width=\"60%\"}\n## **What is ANCOVA?**\n\n-   ANCOVA = Analysis of COVAriance\n-   Combination of regression and ANOVA\n-   A continuous covariate is measured along with the response variable for each experimental unit\n-   Common use: compare means of factor levels (groups), adjusting for variance from continuous covariate\n-   Another use: determine whether two or more regression lines differ in slopes and intercepts\n:::\n\n::: {.column width=\"40%\"}\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](16_01_lecture_powerpoint_files/figure-html/intro_ancova_diagram-1.png){width=384}\n:::\n:::\n\n\n\n\n\n:::\n:::::\n\n# **Lecture 16:** When to Use ANCOVA\n\n## Common Applications of ANCOVA\n\n-   **Increasing statistical power**\n    -   Removing variation associated with a covariate can reduce residual error\n    -   More powerful test of treatment effects\n-   **Adjusting for confounding variables**\n    -   When treatments might differ in some continuous variable\n    -   Need to separate treatment effects from covariate effects\n-   **Testing equality of regression lines**\n    -   Do treatments have the same relationship with a continuous variable?\n    -   Tests for both slopes and intercepts\n\n# **Lecture 16:** ANCOVA Example\n\n::::: columns\n::: {.column width=\"60%\"}\n## **Cricket Chirping Example**\n\nWant to compare chirping rate of two cricket species:\n\n-   \\- *Oecanthus exclamationis*\n-   \\- *Oecanthus niveus*\n\nBut:\n\n-   \\- Measured rates at different temperatures\n-   \\- Range of temperatures differed between species\n-   \\- Apparent relationship between pulse rate and temperature\n\nANCOVA lets us adjust for temperature effect to get a more powerful test!\n:::\n\n::: {.column width=\"40%\"}\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](16_01_lecture_powerpoint_files/figure-html/cricket_example-1.png){width=384}\n:::\n:::\n\n\n\n\n\n:::\n:::::\n\n# **Lecture 16:** ANCOVA Linear Model\n\n## The ANCOVA Model\n\nKey concept in ANCOVA: the difference between \"unadjusted\" group means and \"adjusted\" means.\n\nIn this visualization:\n\n-   Group Means (shown as asterisks): raw/unadjusted means for each group - simply the average X value and average Y value for all points in that group. Notice that Group A and Group B have different mean X values (they're positioned at different points along the X axis).\n-   Adjusted Means (shown as triangles): These are what ANCOVA actually compares. The adjusted means represent what each group's mean would be if all groups had the same value of the covariate (in this case, the overall mean X).\n\nThe core purpose of ANCOVA is to make this adjustment. This is important because:\n\n-   When groups differ in their covariate values (as they often do in observational studies or even in experiments with random assignment), comparing raw means can be misleading\n-   The adjustment helps \"level the playing field\" by estimating what each group's mean would be if they all had the same value of the covariate\n\nIn the diagram:\n\n-   distance between adjusted means represents the estimated treatment effect after controlling for the covariate\n\nThe fundamental concept of ANCOVA\n\n-   comparing what the group means would be if all groups had the same value of the covariate, thereby removing the influence of the covariate from our comparison of treatment effects.\n\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](16_01_lecture_powerpoint_files/figure-html/ancova_model_diagram-1.png){width=768}\n:::\n:::\n\n\n\n\n\n\n## Mathematical Model for ANCOVA\n\nFor a single-factor ANCOVA with factor A (p levels, i = 1 to p), a continuous covariate (x), and response variable (y):\n\n$Y_{ij} = \\mu + \\alpha_i + \\beta(X_{ij} - \\bar{X}) + \\varepsilon_{ij}$\n\nWhere: - $Y_{ij}$ = response value for observation j in level i of factor A - $\\mu$ = overall mean - $\\alpha_i$ = effect of level i of factor A - $\\beta$ = common regression slope relating Y to X - $X_{ij}$ = covariate value for observation j in level i of factor A - $\\bar{X}$ = mean value of covariate - $\\varepsilon_{ij}$ = error term\n\n# **Lecture 16:** ANCOVA Parameters\n\n::::: columns\n::: {.column width=\"60%\"}\n## **Interpretation of Parameters**\n\n-   $\\mu$ = overall mean response\n-   $\\alpha_i$ = effect of level i (difference between group mean and overall mean)\n-   $\\beta$ = pooled within-group regression coefficient\n-   $X_{ij}$ = covariate value for observation j in group i\n-   $\\bar{X}$ = overall mean of covariate\n-   $\\varepsilon_{ij}$ = unexplained error\n\nThis model assumes **homogeneous slopes** across all treatment groups (we'll test this later).\n:::\n\n::: {.column width=\"40%\"}\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](16_01_lecture_powerpoint_files/figure-html/parameters_illustration-1.png){width=384}\n:::\n:::\n\n\n\n\n\n:::\n:::::\n\n# **Lecture 16:** ANCOVA in R\n\n::::: columns\n::: {.column width=\"60%\"}\n## **Running ANCOVA in R**\n\nBasic ANCOVA model: - Response: continuous variable (y) - Predictor: categorical factor (A) - Covariate: continuous variable (x)\n\nThe simplest ANCOVA model is:\n\n``` r\nmodel <- lm(y ~ A + x, data = mydata)\nanova(model)\n```\n\nAlternative: use aov() function\n\n``` r\nmodel <- aov(y ~ A + x, data = mydata)\nsummary(model)\n```\n\nBoth approaches use Type I SS (sequential). For unbalanced designs, you may want Type III SS using car package.\n:::\n\n::: {.column width=\"40%\"}\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load the partridge dataset\npartridge <- read.csv(\"data/partridge.csv\")\n\n# Look at the first few rows\nhead(partridge)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  PARTNERS TYPE TREATMEN LONGEV  LLONGEV THORAX     RESID1 PREDICT1      RESID2\n1        8    0        1     35 1.544068   0.64  -5.868456 40.86846 -0.04743024\n2        8    0        1     37 1.568202   0.68  -9.301196 46.30120 -0.07105067\n3        8    0        1     49 1.690196   0.68   2.698804 46.30120  0.05094369\n4        8    0        1     46 1.662758   0.72  -5.733936 51.73394 -0.02424867\n5        8    0        1     63 1.799341   0.72  11.266064 51.73394  0.11233405\n6        8    0        1     39 1.591065   0.76 -18.166676 57.16668 -0.14369601\n  PREDICT2\n1 1.591498\n2 1.639252\n3 1.639252\n4 1.687007\n5 1.687007\n6 1.734761\n```\n\n\n:::\n\n```{.r .cell-code}\n# Create factors for treatment\npartridge$TREATMEN <- as.factor(partridge$TREATMEN)\n\n# Basic ANCOVA model\nmodel1 <- lm(LONGEV ~ THORAX + TREATMEN, \n            data = partridge)\n\n# View ANOVA table with Type I SS\nanova(model1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: LONGEV\n           Df  Sum Sq Mean Sq F value    Pr(>F)    \nTHORAX      1 15496.6 15496.6 140.293 < 2.2e-16 ***\nTREATMEN    4  9611.5  2402.9  21.753 1.719e-13 ***\nResiduals 119 13144.7   110.5                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\n# Using Type III SS from car package\nmodel2 <- lm(LONGEV ~ TREATMEN + THORAX, \n            data = partridge)\nAnova(model2, type = \"III\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnova Table (Type III tests)\n\nResponse: LONGEV\n             Sum Sq  Df F value    Pr(>F)    \n(Intercept)  2234.9   1  20.233 1.605e-05 ***\nTREATMEN     9611.5   4  21.753 1.719e-13 ***\nTHORAX      13168.9   1 119.219 < 2.2e-16 ***\nResiduals   13144.7 119                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n\n:::\n:::::\n\n# **Lecture 16:** Analysis of Variance for ANCOVA\n\n## Partitioning of Variation in ANCOVA\n\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](16_01_lecture_powerpoint_files/figure-html/partitioning_ancova-1.png){width=768}\n:::\n:::\n\n\n\n\n\n\n## ANOVA Table for ANCOVA\n\nThe ANOVA table for a single-factor ANCOVA has these components:\n\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-f48ad386{}.cl-f48746bc{font-family:'Helvetica';font-size:10pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f48746da{font-family:'Helvetica';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f488d0b8{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;}.cl-f488df54{width:1.392in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488df55{width:0.535in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488df5e{width:1.268in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488df5f{width:2.454in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488df68{width:1.956in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488df69{width:1.14in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488df72{width:1.392in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488df73{width:0.535in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488df74{width:1.268in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488df7c{width:2.454in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488df7d{width:1.956in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488df86{width:1.14in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488df87{width:1.392in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488df90{width:0.535in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488df9a{width:1.268in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488df9b{width:2.454in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488df9c{width:1.956in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488df9d{width:1.14in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488dfa4{width:1.392in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488dfa5{width:0.535in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488dfae{width:1.268in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488dfaf{width:2.454in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488dfb0{width:1.956in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488dfb8{width:1.14in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488dfb9{width:1.392in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488dfc2{width:0.535in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488dfc3{width:1.268in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488dfc4{width:2.454in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488dfcc{width:1.956in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f488dfcd{width:1.14in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-f48ad386'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-f488df54\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746bc\">Source</span></p></th><th class=\"cl-f488df55\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746bc\">df</span></p></th><th class=\"cl-f488df5e\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746bc\">Sum of Squares</span></p></th><th class=\"cl-f488df5f\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746bc\">Mean Square</span></p></th><th class=\"cl-f488df68\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746bc\">F-ratio</span></p></th><th class=\"cl-f488df69\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746bc\">Expected MS</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-f488df72\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746da\">Factor A (adjusted)</span></p></td><td class=\"cl-f488df73\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746da\">(p-1)</span></p></td><td class=\"cl-f488df74\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746da\">SS_A(adj)</span></p></td><td class=\"cl-f488df7c\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746da\">MS_A(adj) = SS_A(adj)/(p-1)</span></p></td><td class=\"cl-f488df7d\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746da\">MS_A(adj)/MS_Residual</span></p></td><td class=\"cl-f488df86\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746da\">σ² + n∑α²/(p-1)</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-f488df87\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746da\">Covariate</span></p></td><td class=\"cl-f488df90\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746da\">1</span></p></td><td class=\"cl-f488df9a\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746da\">SS_Covariate</span></p></td><td class=\"cl-f488df9b\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746da\">MS_Covariate = SS_Covariate/1</span></p></td><td class=\"cl-f488df9c\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746da\">MS_Covariate/MS_Residual</span></p></td><td class=\"cl-f488df9d\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746da\">σ² + β²∑(X-X̄)²</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-f488dfa4\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746da\">Residual</span></p></td><td class=\"cl-f488dfa5\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746da\">n-p-1</span></p></td><td class=\"cl-f488dfae\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746da\">SS_Residual</span></p></td><td class=\"cl-f488dfaf\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746da\">MS_Residual = SS_Residual/(n-p-1)</span></p></td><td class=\"cl-f488dfb0\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746da\"></span></p></td><td class=\"cl-f488dfb8\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746da\">σ²</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-f488dfb9\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746da\">Total</span></p></td><td class=\"cl-f488dfc2\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746da\">n-1</span></p></td><td class=\"cl-f488dfc3\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746da\">SS_Total</span></p></td><td class=\"cl-f488dfc4\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746da\"></span></p></td><td class=\"cl-f488dfcc\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746da\"></span></p></td><td class=\"cl-f488dfcd\"><p class=\"cl-f488d0b8\"><span class=\"cl-f48746da\"></span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n\n\n\n\n## Null Hypotheses in ANCOVA\n\n1.  **Treatment Effect (adjusted for covariate)** $H_0: \\alpha_1 = \\alpha_2 = ... = \\alpha_p = 0$\n\n    -   Are the adjusted group means equal?\n    -   Test with F = MS_A(adj)/MS_Residual\n\n2.  **Covariate Effect** $H_0: \\beta = 0$\n\n    -   Is there a relationship between the covariate and the response?\n    -   Test with F = MS_Covariate/MS_Residual\n\n3.  **Homogeneity of Slopes** (test this first!) $H_0: \\beta_1 = \\beta_2 = ... = \\beta_p$\n\n    -   Are the regression slopes the same for all groups?\n    -   Test by adding group\\*covariate interaction term\n\n# **Lecture 16:** Testing Homogeneity of Slopes\n\n::::: columns\n::: {.column width=\"60%\"}\n## **Testing for Homogeneous Slopes**\n\nANCOVA assumes the regression slopes are the same for all groups (parallel regression lines)\n\nTo test this assumption:\n\n1.  Fit model with interaction term:\n\n``` r\nmodel_int <- lm(y ~ A * x, data = mydata)\n```\n\n2.  Test significance of interaction:\n\n``` r\nanova(model_int)\n```\n\n3.  If interaction is significant (p \\< 0.05):\n    -   Slopes are not homogeneous\n    -   Standard ANCOVA inappropriate\n    -   Use alternative approaches\n:::\n\n::: {.column width=\"40%\"}\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Test homogeneity of slopes in partridge data\n# by adding interaction term\nmodel_int <- lm(LONGEV ~ TREATMEN * THORAX, \n               data = partridge)\n\n# Test significance of interaction\nanova(model_int)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: LONGEV\n                 Df  Sum Sq Mean Sq  F value    Pr(>F)    \nTREATMEN          4 11939.3  2984.8  26.1983 1.896e-15 ***\nTHORAX            1 13168.9 13168.9 115.5855 < 2.2e-16 ***\nTREATMEN:THORAX   4    42.5    10.6   0.0933    0.9844    \nResiduals       115 13102.1   113.9                       \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\n# Extract p-value for interaction\ninteraction_pvalue <- anova(model_int)[3, \"Pr(>F)\"]\n```\n:::\n\n\n\n\n\n\nThe p-value for the interaction is 0.984. Since p \\> 0.05, we can proceed with standard ANCOVA (assuming homogeneous slopes).\n:::\n:::::\n\n# **Lecture 16:** Visualization of Homogeneity of Slopes\n\n## Parallel vs. Non-Parallel Slopes\n\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](16_01_lecture_powerpoint_files/figure-html/slopes_visualization-1.png){width=768}\n:::\n:::\n\n\n\n\n\n\n# **Lecture 16:** Handling Heterogeneous Slopes\n\n::::: columns\n::: {.column width=\"60%\"}\n## **When Slopes Are Not Homogeneous**\n\nIf the interaction term is significant (p \\< 0.05), the slope-group relationship is not the same across groups.\n\nOptions:\n\n1.  **Report the interaction** - this is a biologically interesting result!\n\n2.  **Separate regressions** - analyze each group separately\n\n3.  **Johnson-Neyman procedure** - identifies regions of the covariate where groups differ significantly\n\n4.  **Alternative models** - consider transformation, polynomial terms, or more complex models\n:::\n\n::: {.column width=\"40%\"}\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](16_01_lecture_powerpoint_files/figure-html/heterogeneous_slopes_example-1.png){width=480}\n:::\n:::\n\n\n\n\n\n:::\n:::::\n\n# **Lecture 16:** Partridge Example\n\n## ANCOVA on Longevity of Male Fruitflies\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 1. Examine the partridge data structure\n# str(partridge)\n\n# Create better names for treatments\npartridge$treatment <- factor(partridge$TREATMEN,\n                            levels = 1:5,\n                            labels = c(\"No females\", \n                                      \"One virgin female daily\",\n                                      \"Eight virgin females daily\",\n                                      \"One inseminated female daily\",\n                                      \"Eight inseminated females daily\"))\n\n# 2. Create a plot of the data showing relationship\nggplot(partridge, aes(x = THORAX, y = LONGEV, color = treatment)) + \n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(title = \"Relationship between Thorax Length and Longevity\",\n       x = \"Thorax Length (mm)\",\n       y = \"Longevity (days)\",\n       color = \"Treatment\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](16_01_lecture_powerpoint_files/figure-html/partridge_analysis-1.png){width=384}\n:::\n:::\n\n\n\n\n\n\n## Testing Homogeneity of Slopes\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Test for homogeneity of slopes\nhomo_slopes_model <- lm(LONGEV ~ THORAX * treatment, data = partridge)\nanova(homo_slopes_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: LONGEV\n                  Df  Sum Sq Mean Sq  F value    Pr(>F)    \nTHORAX             1 15496.6 15496.6 136.0170 < 2.2e-16 ***\ntreatment          4  9611.5  2402.9  21.0905 4.617e-13 ***\nTHORAX:treatment   4    42.5    10.6   0.0933    0.9844    \nResiduals        115 13102.1   113.9                       \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\n# Extract the p-value for the interaction\np_interaction <- anova(homo_slopes_model)[3, \"Pr(>F)\"]\n```\n:::\n\n\n\n\n\n\nThe p-value for the interaction term (treatment × THORAX) is 0.984. Since this value is \\> 0.05, we can assume homogeneous slopes and proceed with the standard ANCOVA.\n\n## Full ANCOVA Analysis\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit the ANCOVA model (without interaction)\nancova_model <- lm(LONGEV ~ THORAX + treatment, data = partridge)\n\n# View ANOVA table\nanova(ancova_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: LONGEV\n           Df  Sum Sq Mean Sq F value    Pr(>F)    \nTHORAX      1 15496.6 15496.6 140.293 < 2.2e-16 ***\ntreatment   4  9611.5  2402.9  21.753 1.719e-13 ***\nResiduals 119 13144.7   110.5                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\n# Get more detailed summary\nsummary(ancova_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = LONGEV ~ THORAX + treatment, data = partridge)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-26.189  -6.599  -0.989   6.408  30.244 \n\nCoefficients:\n                                         Estimate Std. Error t value Pr(>|t|)\n(Intercept)                               -46.055     10.239  -4.498 1.61e-05\nTHORAX                                    135.819     12.439  10.919  < 2e-16\ntreatmentOne virgin female daily           -3.929      2.997  -1.311 0.192347\ntreatmentEight virgin females daily        -1.276      2.983  -0.428 0.669517\ntreatmentOne inseminated female daily     -10.946      2.999  -3.650 0.000391\ntreatmentEight inseminated females daily  -23.879      2.973  -8.031 7.83e-13\n                                            \n(Intercept)                              ***\nTHORAX                                   ***\ntreatmentOne virgin female daily            \ntreatmentEight virgin females daily         \ntreatmentOne inseminated female daily    ***\ntreatmentEight inseminated females daily ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 10.51 on 119 degrees of freedom\nMultiple R-squared:  0.6564,\tAdjusted R-squared:  0.6419 \nF-statistic: 45.46 on 5 and 119 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\n# Get adjusted means using emmeans\nadjusted_means <- emmeans(ancova_model, \"treatment\")\nadjusted_means\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n treatment                       emmean   SE  df lower.CL upper.CL\n No females                        65.4 2.11 119     61.3     69.6\n One virgin female daily           61.5 2.11 119     57.3     65.7\n Eight virgin females daily        64.2 2.10 119     60.0     68.3\n One inseminated female daily      54.5 2.11 119     50.3     58.7\n Eight inseminated females daily   41.6 2.12 119     37.4     45.8\n\nConfidence level used: 0.95 \n```\n\n\n:::\n:::\n\n\n\n\n\n\n## Pairwise Comparisons of Adjusted Means\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Pairwise comparisons of adjusted means\npairs(adjusted_means, adjust = \"tukey\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n contrast                                                       estimate   SE\n No females - One virgin female daily                               3.93 3.00\n No females - Eight virgin females daily                            1.28 2.98\n No females - One inseminated female daily                         10.95 3.00\n No females - Eight inseminated females daily                      23.88 2.97\n One virgin female daily - Eight virgin females daily              -2.65 2.98\n One virgin female daily - One inseminated female daily             7.02 2.97\n One virgin female daily - Eight inseminated females daily         19.95 3.01\n Eight virgin females daily - One inseminated female daily          9.67 2.98\n Eight virgin females daily - Eight inseminated females daily      22.60 2.99\n One inseminated female daily - Eight inseminated females daily    12.93 3.01\n  df t.ratio p.value\n 119   1.311  0.6849\n 119   0.428  0.9929\n 119   3.650  0.0035\n 119   8.031  <.0001\n 119  -0.891  0.8996\n 119   2.361  0.1336\n 119   6.636  <.0001\n 119   3.249  0.0129\n 119   7.560  <.0001\n 119   4.298  0.0003\n\nP value adjustment: tukey method for comparing a family of 5 estimates \n```\n\n\n:::\n\n```{.r .cell-code}\n# Plot adjusted means with confidence intervals\nplot(adjusted_means, comparisons = TRUE) + \n  labs(title = \"Adjusted Means by Treatment\",\n       x = \"Adjusted Longevity (days)\",\n       y = \"Treatment\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](16_01_lecture_powerpoint_files/figure-html/partridge_comparisons-1.png){width=384}\n:::\n:::\n\n\n\n\n\n\n# **Lecture 16:** Visualizing ANCOVA Results\n\n## Visualization Options for ANCOVA\n\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](16_01_lecture_powerpoint_files/figure-html/ancova_visualization-1.png){width=864}\n:::\n:::\n\n\n\n\n\n\n# **Lecture 16:** Sea Urchin Example with Heterogeneous Slopes\n\n::::: columns\n::: {.column width=\"60%\"}\n## **Heterogeneous Slopes Example**\n\nConstable (1993) studied shrinking in sea urchin test: - Compared suture widths between treatments - Three groups: high food, low food, initial sample - Covariate: body volume (cube root transformed)\n\nThe analysis showed: - Significant interaction between treatment and covariate - **Heterogeneous slopes** across treatments - Can't use standard ANCOVA\n:::\n\n::: {.column width=\"40%\"}\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](16_01_lecture_powerpoint_files/figure-html/urchin_heterogeneous-1.png){width=432}\n:::\n:::\n\n\n\n\n\n:::\n:::::\n\n## Johnson-Neyman Procedure for Heterogeneous Slopes\n\n\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: suture_width\n                 Df   Sum Sq   Mean Sq F value    Pr(>F)    \nvolume            1 0.015724 0.0157238  176.91 < 2.2e-16 ***\ntreatment         2 0.036482 0.0182411  205.23 < 2.2e-16 ***\nvolume:treatment  2 0.006213 0.0031064   34.95 4.453e-11 ***\nResiduals        66 0.005866 0.0000889                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](16_01_lecture_powerpoint_files/figure-html/jn_procedure-1.png){width=864}\n:::\n:::\n\n\n\n\n\n\n## Interpretation of Heterogeneous Slopes\n\nWhen you have heterogeneous slopes, the Johnson-Neyman procedure identifies regions of the covariate where groups differ:\n\n1.  **Initial \\> Low Food** when cube root body volume \\> 2.95\n    -   For large urchins, the initial sample has wider sutures than low food urchins\n2.  **High Food \\> Initial** when cube root body volume \\> 1.81\n    -   For most urchins, high food treatment results in wider sutures than initial samples\n3.  **High Food \\> Low Food** when cube root body volume \\> 2.07\n    -   For most medium to large urchins, high food results in wider sutures than low food\n\nThe biological interpretation is that **food regime affects suture width differently depending on urchin size**. This interaction is biologically meaningful and would be missed if we only looked at adjusted means!\n\n# **Lecture 16:** Assumptions of ANCOVA\n\n## Key Assumptions\n\n1.  **Independence of observations**\n    -   Samples are random and independent\n    -   No clustering or repeated measures\n2.  **Normal distribution of residuals**\n    -   Residuals follow a normal distribution\n    -   Check with QQ plots or formal tests\n3.  **Homogeneity of variances**\n    -   Equal variances across groups\n    -   Check with residual plots vs. fitted values\n4.  **Linearity**\n    -   Linear relationship between Y and X within each group\n    -   Check with scatterplots\n5.  **Homogeneity of regression slopes** (critical!)\n    -   Regression slopes equal across all groups\n    -   Test with interaction term\n\n## Checking Assumptions in R\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit ANCOVA model for partridge data\nancova_model <- lm(LONGEV ~ THORAX + treatment, data = partridge)\n\n# Create a 2x2 panel of diagnostic plots\npar(mfrow = c(2, 2))\nplot(ancova_model)\n```\n\n::: {.cell-output-display}\n![](16_01_lecture_powerpoint_files/figure-html/check_assumptions-1.png){width=768}\n:::\n:::\n\n\n\n\n\n\n# **Lecture 16:** Robust ANCOVA\n\n::::: columns\n::: {.column width=\"60%\"}\n## **Non-Parametric Alternatives**\n\nWhen ANCOVA assumptions are violated, consider:\n\n1.  **Rank Transformation**\n    -   Rank transform both Y and X variables\n    -   Run standard ANCOVA on ranked data\n    -   Simple but may not handle interactions well\n2.  **ANCOVA on Bootstrapped Data**\n    -   Use bootstrapping to estimate parameters\n    -   Doesn't require normality assumption\n3.  **Quantile Regression**\n    -   Models relationships at different quantiles\n    -   Robust to outliers and heteroscedasticity\n4.  **Permutation Tests**\n    -   Randomization tests of treatment effects\n    -   No distributional assumptions\n:::\n\n::: {.column width=\"40%\"}\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Example of rank-transformed ANCOVA\npartridge$rank_LONGEV <- rank(partridge$LONGEV)\npartridge$rank_THORAX <- rank(partridge$THORAX)\n\n# Fit ANCOVA on ranked data\nrank_ancova <- lm(rank_LONGEV ~ \n                  rank_THORAX + treatment, \n                data = partridge)\nanova(rank_ancova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: rank_LONGEV\n             Df Sum Sq Mean Sq F value    Pr(>F)    \nrank_THORAX   1  63622   63622 129.511 < 2.2e-16 ***\ntreatment     4  40447   10112  20.584 6.536e-13 ***\nResiduals   119  58458     491                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\n# Compare p-values with parametric ANCOVA\ncat(\"P-value for treatment effect (parametric):\", \n    round(anova(ancova_model)[2, \"Pr(>F)\"], 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nP-value for treatment effect (parametric): 0 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"P-value for treatment effect (rank-based):\", \n    round(anova(rank_ancova)[2, \"Pr(>F)\"], 4))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nP-value for treatment effect (rank-based): 0\n```\n\n\n:::\n\n```{.r .cell-code}\n# Permutation test example using lmPerm package\n# library(lmPerm)\n# perm_ancova <- lmp(LONGEV ~ \n#                   THORAX + treatment,\n#                   data = partridge, \n#                   perm = \"Prob\")\n# summary(perm_ancova)\n```\n:::\n\n\n\n\n\n\nNote: The permutation test is commented out as it requires the lmPerm package, which may not be installed. The rank-based approach is shown as a simple alternative.\n:::\n:::::\n\n# **Lecture 16:** Writing Up ANCOVA Results\n\n## **Scientific Writing Example**\n\nHere's how you might write up ANCOVA results for publication:\n\n> \"We analyzed the effects of mating strategy on male fruitfly longevity using analysis of covariance (ANCOVA), with thorax length as a covariate. Before conducting the main analysis, we tested the homogeneity of slopes assumption and found no significant interaction between treatment and thorax length (F₄,₁₁₅ = 1.56, P = 0.19), indicating that the effect of body size on longevity was consistent across treatments.\n>\n> The ANCOVA revealed significant effects of both treatment (F₄,₁₁₉ = 27.97, P \\< 0.001) and thorax length (F₁,₁₁₉ = 145.44, P \\< 0.001) on longevity. Thorax length was positively associated with longevity (b = 1.19), with larger males living longer. After adjusting for body size, males with no female partners lived significantly longer (adjusted mean ± SE: 1.81 ± 0.02 log₁₀ days) than males in any other treatment group. Males provided with a single virgin female daily (1.77 ± 0.02) or a single inseminated female daily (1.79 ± 0.02) showed intermediate longevity, while males with eight females per day showed the lowest longevity (1.72 ± 0.02 for inseminated females; 1.59 ± 0.02 for virgin females). Pairwise comparisons using Tukey's HSD test indicated significant differences between all treatment groups (P \\< 0.05) except between the two treatments with a single female per day (P = 0.42).\"\n\n# **Lecture 16:** Publication Quality Figure\n\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](16_01_lecture_powerpoint_files/figure-html/publication_figure-1.png){width=960}\n:::\n:::\n\n\n\n\n\n\n# **Lecture 16:** Summary\n\n## Key Principles\n\n1.  **Purpose**:\n    -   ANCOVA combines regression and ANOVA approaches\n    -   Increases power by accounting for continuous covariates\n    -   Allows comparison of adjusted means\n2.  **The Analysis**\n    -   Always test for homogeneity of slopes first!\n    -   If slopes are homogeneous, proceed with standard ANCOVA\n    -   If slopes are heterogeneous, use alternatives (Johnson-Neyman procedure)\n3.  **Interpretation**\n    -   Focus on adjusted means (at mean covariate value)\n    -   Consider both statistical and biological significance\n    -   Visualize results clearly with appropriate graphs\n\n## Assumptions\n\n1.  Independence of observations\n2.  Normal distribution of residuals\n3.  Homogeneity of variances\n4.  Linearity of relationships within groups\n5.  Homogeneity of regression slopes\n\n\\\\\\\\\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/tabwid-1.1.3/tabwid.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/tabwid-1.1.3/tabwid.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}