{
  "hash": "3d85b450dc268e4e2dd0aa66df825e95",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"How an ANOVA IS A REGRESSION WIHT DUMMY VARIABLES \"\nauthor: \"Bill Perry\"\nexecute:\n  freeze: auto\n  cache: true\n  echo: true\n  keep-md: true\n  message: false\n  warning: false\n  fig-height: 5\n  fig-width: 4\n  paged-print: false\nformat:\n  html:\n    toc: false\n    output-file: \"12_04_how_anova_is_regression_html.html\"\n    embed-resources: true\n    self-contained: true\n    max-width: 80ch\n    css: ../../css/lecture.css\n  revealjs:\n    output-file: \"12_04_how_anova_is_regression_slides.html\"\n    self-contained: true\n    css: ../../css/lecture.css\n    slide-number: true\n    transition: fade\n  docx:\n    default: true\n    toc: false\n    toc-depth: 3\n    number-sections: true\n    highlight-style: github\n    reference-doc: ../../ms_templates/custom-reference.docx\n    css: msword.css\n    embed-resources: true\n  pptx:\n    reference-doc: ../../ms_templates/lecture_template.pptx \n    embed-resources: true\neditor: visual\n---\n\n\n\n\n\n\n# Introduction\n\nThis document demonstrates how Analysis of Variance (ANOVA) is mathematically equivalent to a regression model with dummy variables using an example with R code and visualizations.\n\n# Setup and Data Creation\n\nLet's begin by loading necessary packages and creating a dataframe about plant heights with three different fertilizer treatments.\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# install.packages(\"flextable\")\nlibrary(tidyverse)\nlibrary(flextable)\n\n# Create the dataset\nfertilizer_data <- tibble(\n  fertilizer = rep(c(\"A\", \"B\", \"C\"), each = 3),\n  height = c(10, 12, 8,   # Fertilizer A\n             14, 16, 18,  # Fertilizer B\n             20, 22, 24)  # Fertilizer C\n)\n\n# Display the dataset using flextable\nflextable(fertilizer_data) %>%\n  set_caption(\"Plant Heights by Fertilizer Type\") %>%\n  theme_vanilla() %>%\n  autofit()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-f402d71a{}.cl-f3ff6850{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f3ff6864{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f400cff6{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f400cff7{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f400deec{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f400deed{width:0.743in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f400def6{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f400def7{width:0.743in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f400df00{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f400df01{width:0.743in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f400df0a{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f400df0b{width:0.743in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f400df0c{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f400df14{width:0.743in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f400df15{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f400df16{width:0.743in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f400df1e{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f400df1f{width:0.743in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-f402d71a'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-f400deec\"><p class=\"cl-f400cff6\"><span class=\"cl-f3ff6850\">fertilizer</span></p></th><th class=\"cl-f400deed\"><p class=\"cl-f400cff7\"><span class=\"cl-f3ff6850\">height</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-f400def6\"><p class=\"cl-f400cff6\"><span class=\"cl-f3ff6864\">A</span></p></td><td class=\"cl-f400def7\"><p class=\"cl-f400cff7\"><span class=\"cl-f3ff6864\">10</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-f400df00\"><p class=\"cl-f400cff6\"><span class=\"cl-f3ff6864\">A</span></p></td><td class=\"cl-f400df01\"><p class=\"cl-f400cff7\"><span class=\"cl-f3ff6864\">12</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-f400df0a\"><p class=\"cl-f400cff6\"><span class=\"cl-f3ff6864\">A</span></p></td><td class=\"cl-f400df0b\"><p class=\"cl-f400cff7\"><span class=\"cl-f3ff6864\">8</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-f400df00\"><p class=\"cl-f400cff6\"><span class=\"cl-f3ff6864\">B</span></p></td><td class=\"cl-f400df01\"><p class=\"cl-f400cff7\"><span class=\"cl-f3ff6864\">14</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-f400df0c\"><p class=\"cl-f400cff6\"><span class=\"cl-f3ff6864\">B</span></p></td><td class=\"cl-f400df14\"><p class=\"cl-f400cff7\"><span class=\"cl-f3ff6864\">16</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-f400df0a\"><p class=\"cl-f400cff6\"><span class=\"cl-f3ff6864\">B</span></p></td><td class=\"cl-f400df0b\"><p class=\"cl-f400cff7\"><span class=\"cl-f3ff6864\">18</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-f400df15\"><p class=\"cl-f400cff6\"><span class=\"cl-f3ff6864\">C</span></p></td><td class=\"cl-f400df16\"><p class=\"cl-f400cff7\"><span class=\"cl-f3ff6864\">20</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-f400df15\"><p class=\"cl-f400cff6\"><span class=\"cl-f3ff6864\">C</span></p></td><td class=\"cl-f400df16\"><p class=\"cl-f400cff7\"><span class=\"cl-f3ff6864\">22</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-f400df1e\"><p class=\"cl-f400cff6\"><span class=\"cl-f3ff6864\">C</span></p></td><td class=\"cl-f400df1f\"><p class=\"cl-f400cff7\"><span class=\"cl-f3ff6864\">24</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n\n\n\n\n# Calculating Group Means (ANOVA Approach)\n\nIn ANOVA, we calculate the mean of each group and compare variation between groups to variation within groups.\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngroup_means <- fertilizer_data %>%\n  group_by(fertilizer) %>%\n  summarize(mean_height = mean(height))\n\nflextable(group_means) %>%\n  set_caption(\"Group Means (ANOVA Approach)\") %>%\n  theme_vanilla() %>%\n  autofit()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-f4200812{}.cl-f41ce196{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f41ce1a0{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f41e289e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f41e28a8{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f41e3618{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f41e3619{width:1.228in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f41e361a{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f41e3622{width:1.228in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f41e3623{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f41e3624{width:1.228in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f41e362c{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f41e362d{width:1.228in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-f4200812'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-f41e3618\"><p class=\"cl-f41e289e\"><span class=\"cl-f41ce196\">fertilizer</span></p></th><th class=\"cl-f41e3619\"><p class=\"cl-f41e28a8\"><span class=\"cl-f41ce196\">mean_height</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-f41e361a\"><p class=\"cl-f41e289e\"><span class=\"cl-f41ce1a0\">A</span></p></td><td class=\"cl-f41e3622\"><p class=\"cl-f41e28a8\"><span class=\"cl-f41ce1a0\">10</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-f41e3623\"><p class=\"cl-f41e289e\"><span class=\"cl-f41ce1a0\">B</span></p></td><td class=\"cl-f41e3624\"><p class=\"cl-f41e28a8\"><span class=\"cl-f41ce1a0\">16</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-f41e362c\"><p class=\"cl-f41e289e\"><span class=\"cl-f41ce1a0\">C</span></p></td><td class=\"cl-f41e362d\"><p class=\"cl-f41e28a8\"><span class=\"cl-f41ce1a0\">22</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n\n\n\n\nLet's visualize the raw data and group means:\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(fertilizer_data, aes(x = fertilizer, y = height)) +\n  geom_jitter(width = 0.1, alpha = 0.6) +\n  geom_point(data = group_means, aes(y = mean_height), \n             color = \"red\", size = 3) +\n  labs(title = \"Plant Height by Fertilizer Type\",\n       x = \"Fertilizer Type\",\n       y = \"Plant Height (cm)\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](12_04_how_anova_is_dummy_var_regression_files/figure-html/plot-raw-data-1.png){width=384}\n:::\n:::\n\n\n\n\n\n\n# Running the ANOVA\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Run ANOVA\nanova_model <- aov(height ~ fertilizer, data = fertilizer_data)\nanova_summary <- summary(anova_model)\nanova_summary\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df Sum Sq Mean Sq F value Pr(>F)   \nfertilizer   2    216     108      27  0.001 **\nResiduals    6     24       4                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n\n\n# Regression with Dummy Variables\n\nFor the regression approach, we'll create dummy variables for fertilizer types, using fertilizer A as the reference level.\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Set fertilizer A as the reference level\nfertilizer_data$fertilizer <- factor(fertilizer_data$fertilizer, levels = c(\"A\", \"B\", \"C\"))\n\n# Run regression with dummy variables\nreg_model <- lm(height ~ fertilizer, data = fertilizer_data)\nreg_summary <- summary(reg_model)\nreg_summary\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = height ~ fertilizer, data = fertilizer_data)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n    -2     -2      0      2      2 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   10.000      1.155   8.660 0.000131 ***\nfertilizerB    6.000      1.633   3.674 0.010402 *  \nfertilizerC   12.000      1.633   7.348 0.000325 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2 on 6 degrees of freedom\nMultiple R-squared:    0.9,\tAdjusted R-squared:  0.8667 \nF-statistic:    27 on 2 and 6 DF,  p-value: 0.001\n```\n\n\n:::\n:::\n\n\n\n\n\n\n# Understanding the Regression Coefficients\n\nIn our regression model:\n\n-   The intercept (10) is equal to the mean of the reference group (A)\n-   The coefficient for fertilizer B (6) is the difference between mean of group B and mean of group A\n-   The coefficient for fertilizer C (12) is the difference between mean of group C and mean of group A\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a table showing the relationship between coefficients and means\ncoefs <- coef(reg_model)\n\ncoefficients_explained <- tibble(\n  Term = c(\"Intercept\", \"fertilizerB\", \"fertilizerC\"),\n  Coefficient = coefs,\n  Meaning = c(\n    \"Mean of Group A (reference group)\",\n    \"Difference between Group B and Group A means\",\n    \"Difference between Group C and Group A means\"\n  ),\n  Mathematical_Expression = c(\n    \"β₀ = μA\",\n    \"β₁ = μB - μA\",\n    \"β₂ = μC - μA\"\n  ),\n  Numeric_Value = c(coefs[1],\n    paste0(round(group_means$mean_height[2], 1), \" - \", \n           round(group_means$mean_height[1], 1), \" = \", \n           round(coefs[2], 1)),\n    paste0(round(group_means$mean_height[3], 1), \" - \", \n           round(group_means$mean_height[1], 1), \" = \", \n           round(coefs[3], 1))))\n\n# Use flextable to format the table\nflextable(coefficients_explained) %>%\n  set_caption(\"Regression Coefficients Explained\") %>%\n  theme_vanilla() %>%\n  fit_to_width(max_width = 8, unit = \"in\") %>%\n  bold(j = 1) %>%\n  colformat_double(j = 2, digits = 2)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-d56629a0{}.cl-d562a0f0{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d562a104{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d5642326{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d5642327{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d56431b8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d56431b9{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d56431ba{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d56431c2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d56431c3{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d56431c4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d56431cc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d56431cd{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-d56629a0'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-d56431b8\"><p class=\"cl-d5642326\"><span class=\"cl-d562a0f0\">Term</span></p></th><th class=\"cl-d56431b9\"><p class=\"cl-d5642327\"><span class=\"cl-d562a0f0\">Coefficient</span></p></th><th class=\"cl-d56431b8\"><p class=\"cl-d5642326\"><span class=\"cl-d562a0f0\">Meaning</span></p></th><th class=\"cl-d56431b8\"><p class=\"cl-d5642326\"><span class=\"cl-d562a0f0\">Mathematical_Expression</span></p></th><th class=\"cl-d56431b8\"><p class=\"cl-d5642326\"><span class=\"cl-d562a0f0\">Numeric_Value</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-d56431ba\"><p class=\"cl-d5642326\"><span class=\"cl-d562a0f0\">Intercept</span></p></td><td class=\"cl-d56431c2\"><p class=\"cl-d5642327\"><span class=\"cl-d562a104\">10.00</span></p></td><td class=\"cl-d56431ba\"><p class=\"cl-d5642326\"><span class=\"cl-d562a104\">Mean of Group A (reference group)</span></p></td><td class=\"cl-d56431ba\"><p class=\"cl-d5642326\"><span class=\"cl-d562a104\">β₀ = μA</span></p></td><td class=\"cl-d56431ba\"><p class=\"cl-d5642326\"><span class=\"cl-d562a104\">10</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-d56431c3\"><p class=\"cl-d5642326\"><span class=\"cl-d562a0f0\">fertilizerB</span></p></td><td class=\"cl-d56431c4\"><p class=\"cl-d5642327\"><span class=\"cl-d562a104\">6.00</span></p></td><td class=\"cl-d56431c3\"><p class=\"cl-d5642326\"><span class=\"cl-d562a104\">Difference between Group B and Group A means</span></p></td><td class=\"cl-d56431c3\"><p class=\"cl-d5642326\"><span class=\"cl-d562a104\">β₁ = μB - μA</span></p></td><td class=\"cl-d56431c3\"><p class=\"cl-d5642326\"><span class=\"cl-d562a104\">16 - 10 = 6</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-d56431cc\"><p class=\"cl-d5642326\"><span class=\"cl-d562a0f0\">fertilizerC</span></p></td><td class=\"cl-d56431cd\"><p class=\"cl-d5642327\"><span class=\"cl-d562a104\">12.00</span></p></td><td class=\"cl-d56431cc\"><p class=\"cl-d5642326\"><span class=\"cl-d562a104\">Difference between Group C and Group A means</span></p></td><td class=\"cl-d56431cc\"><p class=\"cl-d5642326\"><span class=\"cl-d562a104\">β₂ = μC - μA</span></p></td><td class=\"cl-d56431cc\"><p class=\"cl-d5642326\"><span class=\"cl-d562a104\">22 - 10 = 12</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n\n\n\n\nLet's visualize these coefficients:\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoef_data <- tibble(\n  Term = factor(c(\"Intercept\\n(Group A Mean)\", \"Group B - Group A\", \"Group C - Group A\"),\n                levels = c(\"Intercept\\n(Group A Mean)\", \"Group B - Group A\", \"Group C - Group A\")),\n  Value = c(coefs[1], coefs[2], coefs[3])\n)\n\nggplot(coef_data, aes(x = Term, y = Value)) +\n  geom_col(fill = \"steelblue\") +\n  geom_text(aes(label = round(Value, 1)), vjust = -0.5) +\n  labs(title = \"Regression Coefficients with Dummy Variables\",\n       subtitle = \"Intercept represents Group A mean; other coefficients show differences from reference\",\n       x = \"\",\n       y = \"Coefficient Value (cm)\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](12_04_how_anova_is_dummy_var_regression_files/figure-html/plot-coefficients-1.png){width=384}\n:::\n:::\n\n\n\n\n\n\n# Demonstrating the Equivalence\n\nNow, let's prove that the regression model predictions are identical to the ANOVA group means:\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get predictions from regression model\npredicted_values <- predict(reg_model, fertilizer_data)\n\n# Create a dataframe for comparison\ncomparison_data <- fertilizer_data %>%\n  mutate(predicted = predicted_values) %>%\n  group_by(fertilizer) %>%\n  mutate(group_mean = mean(height))\n\n# Generate the predicted values for each group\npredicted_values_by_group <- comparison_data %>%\n  group_by(fertilizer) %>%\n  reframe(\n    anova_mean = mean(height),\n    regression_prediction = mean(predicted),\n    formula = case_when(\n      fertilizer == \"A\" ~ paste0(round(coefs[1], 1), \" + 0 + 0 = \", round(coefs[1], 1)),\n      fertilizer == \"B\" ~ paste0(round(coefs[1], 1), \" + \", round(coefs[2], 1), \" + 0 = \", round(coefs[1] + coefs[2], 1)),\n      fertilizer == \"C\" ~ paste0(round(coefs[1], 1), \" + 0 + \", round(coefs[3], 1), \" = \", round(coefs[1] + coefs[3], 1))\n    )\n  )\n```\n:::\n\n\n\n\n\n\nLet's visualize this equivalence:\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create data for plotting the equivalence\nplot_data <- predicted_values_by_group %>%\n  pivot_longer(cols = c(anova_mean, regression_prediction),\n               names_to = \"method\",\n               values_to = \"value\") %>%\n  mutate(method = ifelse(method == \"anova_mean\", \"ANOVA Group Mean\", \"Regression Prediction\"))\n\nggplot(plot_data, aes(x = fertilizer, y = value, fill = method)) +\n  geom_bar(stat = \"identity\", position = position_dodge(), alpha = 0.7) +\n  geom_text(aes(label = round(value, 1)), position = position_dodge(width = 0.9), vjust = -0.5) +\n  labs(title = \"ANOVA Mean vs. Regression Prediction by Fertilizer Type\",\n       subtitle = \"Both methods produce identical values\",\n       x = \"Fertilizer Type\",\n       y = \"Plant Height (cm)\",\n       fill = \"Method\") +\n  theme_minimal() +\n  scale_fill_brewer(palette = \"Set1\")\n```\n\n::: {.cell-output-display}\n![](12_04_how_anova_is_dummy_var_regression_files/figure-html/equivalence-plot-1.png){width=384}\n:::\n:::\n\n\n\n\n\n\n# Comparing Statistical Tests\n\nBoth ANOVA and regression provide an F-test. Let's compare them:\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ANOVA: Extract F-value and p-value\nanova_f <- anova_summary[[1]]$`F value`[1]\nanova_p <- anova_summary[[1]]$`Pr(>F)`[1]\n\n# Regression: Extract F-value and p-value\nreg_f <- reg_summary$fstatistic[1]\nreg_p <- pf(reg_f, reg_summary$fstatistic[2], reg_summary$fstatistic[3], lower.tail = FALSE)\n\n# Compare them\ntest_comparison <- tibble(\n  Test = c(\"ANOVA F-test\", \"Regression F-test\"),\n  `F-value` = c(anova_f, reg_f),\n  `p-value` = c(anova_p, reg_p)\n)\n\n# Format with flextable\nflextable(test_comparison) %>%\n  set_caption(\"Comparison of Statistical Tests\") %>%\n  theme_vanilla() %>%\n  autofit() %>%\n  colformat_double(j = 2:3, digits = 4)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-f44ba0da{}.cl-f448d850{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f448d85a{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f44a039c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f44a039d{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f44a0f86{width:1.491in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f44a0f90{width:0.82in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f44a0f91{width:1.491in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f44a0f92{width:0.82in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f44a0f9a{width:1.491in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f44a0f9b{width:0.82in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-f44ba0da'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-f44a0f86\"><p class=\"cl-f44a039c\"><span class=\"cl-f448d850\">Test</span></p></th><th class=\"cl-f44a0f90\"><p class=\"cl-f44a039d\"><span class=\"cl-f448d850\">F-value</span></p></th><th class=\"cl-f44a0f90\"><p class=\"cl-f44a039d\"><span class=\"cl-f448d850\">p-value</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-f44a0f91\"><p class=\"cl-f44a039c\"><span class=\"cl-f448d85a\">ANOVA F-test</span></p></td><td class=\"cl-f44a0f92\"><p class=\"cl-f44a039d\"><span class=\"cl-f448d85a\">27.0000</span></p></td><td class=\"cl-f44a0f92\"><p class=\"cl-f44a039d\"><span class=\"cl-f448d85a\">0.0010</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-f44a0f9a\"><p class=\"cl-f44a039c\"><span class=\"cl-f448d85a\">Regression F-test</span></p></td><td class=\"cl-f44a0f9b\"><p class=\"cl-f44a039d\"><span class=\"cl-f448d85a\">27.0000</span></p></td><td class=\"cl-f44a0f9b\"><p class=\"cl-f44a039d\"><span class=\"cl-f448d85a\">0.0010</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n\n\n\n\n# The Mathematical Relationship\n\nFor a one-way ANOVA with a categorical variable having `k` levels, we can express the relationship with regression as:\n\n$$Y = \\beta_0 + \\beta_1X_1 + \\beta_2X_2 + ... + \\beta_{k-1}X_{k-1} + \\epsilon$$\n\nWhere: - $\\beta_0$ is the mean of the reference group - $\\beta_1, \\beta_2, ..., \\beta_{k-1}$ are the differences between each group's mean and the reference group mean - $X_1, X_2, ..., X_{k-1}$ are dummy variables (0 or 1)\n\nIn our example: - $\\beta_0 = 10$ (mean of group A) - $\\beta_1 = 6$ (difference between B and A) - $\\beta_2 = 12$ (difference between C and A)\n\n# Conclusion\n\nThis demonstration shows that one-way ANOVA is mathematically equivalent to regression with dummy variables. The key equivalences are:\n\n1.  ANOVA group means = Regression predictions for each group\n2.  F-statistic from ANOVA = F-statistic from regression\n3.  p-values are identical in both approaches\n\nThis confirms that both techniques are special cases of the General Linear Model, just expressed in different ways. For a categorical predictor with `k` levels, we need `k-1` dummy variables in the regression approach, with one level serving as the reference category.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/tabwid-1.1.3/tabwid.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/tabwid-1.1.3/tabwid.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}