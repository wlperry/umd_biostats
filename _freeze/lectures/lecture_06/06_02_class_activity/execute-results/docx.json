{
  "hash": "f95a74a429bf8fa86a8ebff5c42b7cd6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"06_Class_Activity\"\nauthor: \"Bill Perry\"\nexecute:\n  freeze: auto\n  cache: true\n  echo: true\n  keep-md: true # retains the images when you start again\n  message: false\n  warning: false\n  fig-height: 3\n  fig-width: 3\n  paged-print: false\nformat:\n  html:\n    freeze: false\n    toc: false\n    output-file: \"05_02_class_activity.html\"\n    default: true\n    embed-resources: true\n    self-contained: true\n    max-width: 80ch  # Limits line length to approximately 80 characters\n    css: ../../css/activity.css\n  docx:\n    default: true\n    toc: false\n    toc-depth: 3\n    number-sections: false\n    highlight-style: github\n    reference-doc: ../../ms_templates/custom-reference.docx\n    css: msword.css\n    embed-resources: true\n---\n\n\n\n\n\n\n# In class activity 6:\n\n## What did we do last time in activity 5?\n\n-   Understanding standard normal distributions and z-scores\n-   Calculating and interpreting standard error\n-   Creating confidence intervals\n-   Working with the Student’s t-distribution\n\n## Today's focus:\n\n-   Review more r code\n-   understand α alpha and **β** beta errors\n-   do more\n    -   1 sample t tests\n    -   2 sample t tests\n\n# Goes with Lecture 6\n\n::::: columns\n::: {.column width=\"60%\"}\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Install packages if needed (uncomment if necessary)\n# install.packages(\"readr\")\n# install.packages(\"tidyverse\")\n# install.packages(\"car\")\n# install.packages(\"here\")\n\n# Load libraries\nlibrary(patchwork)\nlibrary(car)          # For diagnostic tests\nlibrary(tidyverse)    # For data manipulation and visualization\n```\n:::\n\n\n\n\n\n:::\n\n::: {.column width=\"40%\"}\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load the pine needle data\n# Use here() function to specify the path\npine_data <- read_csv(\"data/pine_needles.csv\")\n\n# Examine the first few rows\nhead(pine_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 6\n  date    group       n_s   wind  tree_no length_mm\n  <chr>   <chr>       <chr> <chr>   <dbl>     <dbl>\n1 3/20/25 cephalopods n     lee         1        20\n2 3/20/25 cephalopods n     lee         1        21\n3 3/20/25 cephalopods n     lee         1        23\n4 3/20/25 cephalopods n     lee         1        25\n5 3/20/25 cephalopods n     lee         1        21\n6 3/20/25 cephalopods n     lee         1        16\n```\n\n\n:::\n:::\n\n\n\n\n\n:::\n:::::\n\n# **Part 1:** Exploratory Data Analysis\n\nBefore conducting hypothesis tests, we should always explore our data to understand its characteristics.\n\nLet's calculate summary statistics and create visualizations.\n\n**Activity: Calculate basic summary statistics for pine needle length**\n\n\n\n\n\n\n::: {.cell exercise='true'}\n\n```{.r .cell-code}\n# YOUR TASK: Calculate summary statistics for pine needle length\n# Hint: Use summarize() function to calculate mean, sd, n, etc.\n\n# Create a summary table for all pine needles\npine_summary <- pine_data %>%\n  group_by(wind) %>% \n  summarize(\n    mean_length = mean(length_mm, na.rm=TRUE),\n    sd_length = sd(length_mm, na.rm=TRUE),\n    n = sum(!is.na(length_mm)),\n    se_length = sd_length / (n^0.5),\n    t_critical = qt(0.975, df = n - 1),  # 95% CI uses 0.975 (two-tailed)\n    ci_lower = mean_length - t_critical * se_length,\n    ci_upper = mean_length + t_critical * se_length\n  )\n\nprint(pine_summary)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 8\n  wind  mean_length sd_length     n se_length t_critical ci_lower ci_upper\n  <chr>       <dbl>     <dbl> <int>     <dbl>      <dbl>    <dbl>    <dbl>\n1 lee          20.4      2.45    24     0.500       2.07     19.4     21.5\n2 wind         14.9      1.91    24     0.390       2.07     14.1     15.7\n```\n\n\n:::\n\n```{.r .cell-code}\n# Now calculate summary statistics by wind exposure\n# YOUR CODE HERE\n```\n:::\n\n\n\n\n\n\n# **Part 1:** Visualizing the Data\n\n::::: columns\n::: {.column width=\"60%\"}\n**Activity: Create visualizations of pine needle length**\n\nCreate a histogram and a boxplot to visualize the distribution of pine needle length values.\n:::\n\n::: {.column width=\"40%\"}\nEffective data visualization helps us understand:\n\n-   The central tendency\n-   The spread of the data\n-   Potential outliers\n-   Shape of distribution\n:::\n:::::\n\n# Your Task\n\n\n\n\n\n\n::: {.cell exercise='true'}\n\n```{.r .cell-code}\n# YOUR TASK: Create a histogram of pine needle length\n# Hint: Use ggplot() and geom_histogram()\n\n# Histogram of all pine needle lengths\nggplot(pine_data, aes(x = length_mm)) +\n  geom_histogram(binwidth = 2, fill = \"steelblue\", color = \"black\") +\n  labs(title = \"Distribution of Pine Needle Length\",\n       x = \"Length (mm)\",\n       y = \"Frequency\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](06_02_class_activity_files/figure-docx/visualize-1.png)\n:::\n\n```{.r .cell-code}\n# how can you do this by wind to see both plots\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Boxplot of pine needle length by wind exposure\n# YOUR CODE HERE\n```\n:::\n\n\n\n\n\n\n# Can you plot the density distributions for the two samples\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Histogram of all pine needle lengths\npine_data %>% \n  ggplot(aes(x = length_mm, fill=wind)) +\n  geom_density(color = \"black\", alpha=0.3, trim = TRUE) +\n  labs(title = \"Pine Needle Lengths by Wind Exposure\",\n       x = \"Position\",\n       y = \"Length (mm)\",\n       fill = \"Wind Position\") +\n\n  scale_fill_manual(values = c(\"lee\" = \"forestgreen\", \"wind\" = \"skyblue\"),\n                   labels = c(\"lee\" = \"Leeward\", \"wind\" = \"Windward\"))\n```\n\n::: {.cell-output-display}\n![](06_02_class_activity_files/figure-docx/density_dist-1.png)\n:::\n:::\n\n\n\n\n\n\n# what is the Effect size or difference in means?\n\n::: callout-tip\n## Practice Exercise: Calculate Effect size\n\nWe could also look at the difference in means... some cool code here\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Assuming your dataframe is called df\npine_summary %>%\n  summarize(difference =  mean_length[wind == \"lee\"] -mean_length[wind == \"wind\"])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 1\n  difference\n       <dbl>\n1        5.5\n```\n\n\n:::\n:::\n\n\n\n\n\n:::\n\n# **Part 1:** Two Sample T-Test\n\nNow, let's compare pine needle lengths between windward and leeward sides of trees.\n\nQuestion: **Is there a significant difference in needle length between the windward and leeward sides?**\n\nThis requires a two-sample t-test.\n\nTwo-sample t-test compares means from two independent groups.\n\n## $t = \\frac{\\bar{x}_1 - \\bar{x}_2}{S_p\\sqrt{\\frac{1}{n_1} + \\frac{1}{n_2}}}$\n\nwhere:\n\n-   x̄₁ and x̄₂: These represent the sample means of the two groups you're comparing \n-   s²ₚ: This is the pooled variance, calculated as: s²ₚ = \\[(n₁ - 1)s₁² + (n₂ - 1)s₂²\\] / (n₁ + n₂ - 2), where s₁² and s₂² are the sample variances of the two groups.\n-   **n₁ and n₂:** These are the sample sizes of the two groups.\n-   **√(1/n₁ + 1/n₂):** This represents the pooled standard error.\n\n# \n\n# **Part 1:** Testing Assumptions for Two-Sample T-Test\n\n**Activity: Test assumptions for two-sample t-test**\n\nFor a two-sample t-test, we need to check:\n\n1.  Normality within each group\n2.  Equal variances between groups (for standard t-test)\n3.  Independent observations\n\nIf assumptions are violated:\n\n-   Welch's t-test (unequal variances)\n-   Non-parametric alternatives (Mann-Whitney U test)\n\n# Your task\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# YOUR TASK: Test normality of windward pine needle lengths\n# QQ Plot\nqqPlot(pine_data$length_mm, \n       main = \"QQ Plot for Windward Pine Needles\",\n       ylab = \"Sample Quantiles\")\n```\n\n::: {.cell-output-display}\n![](06_02_class_activity_files/figure-docx/unnamed-chunk-3-1.png)\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1]  4 28\n```\n\n\n:::\n:::\n\n::: {.cell exercise='true'}\n\n```{.r .cell-code}\n# Testing normality for each group\n# Leeward group\nlee_data <- pine_data %>% filter(wind == \"lee\")\nshapiro_lee <- shapiro.test(lee_data$length_mm)\nprint(\"Shapiro-Wilk test for leeward data:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Shapiro-Wilk test for leeward data:\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(shapiro_lee)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  lee_data$length_mm\nW = 0.95477, p-value = 0.3425\n```\n\n\n:::\n:::\n\n\n\n\n\n\n# windward group\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Windward group\n# YOUR CODE HERE for windward group normality test\n```\n:::\n\n\n\n\n\n\n# Remember you can always do it in one go\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# there are always two ways\n# Test for normality using Shapiro-Wilk test for each wind group\n# All in one pipeline using tidyverse approach\nnormality_results <- pine_data %>%\n  group_by(wind) %>%\n  summarize(\n    shapiro_stat = shapiro.test(length_mm)$statistic,\n    shapiro_p_value = shapiro.test(length_mm)$p.value,\n    normal_distribution = if_else(shapiro_p_value > 0.05, \"Normal\", \"Non-normal\")\n  )\n\n# Print the results\nprint(normality_results)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 4\n  wind  shapiro_stat shapiro_p_value normal_distribution\n  <chr>        <dbl>           <dbl> <chr>              \n1 lee          0.955           0.343 Normal             \n2 wind         0.961           0.451 Normal             \n```\n\n\n:::\n:::\n\n\n\n\n\n\n# Conduct a Levene's Test\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Test for equal variances\n# YOUR TASK: Conduct Levene's test for equality of variances\nlevene_test <- leveneTest(length_mm ~ wind, data = pine_data)\nprint(levene_test)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLevene's Test for Homogeneity of Variance (center = median)\n      Df F value Pr(>F)\ngroup  1  1.2004 0.2789\n      46               \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Visual check for normality with QQ plots\n# YOUR CODE HERE\n```\n:::\n\n\n\n\n\n\n# **Part 2:** Conducting the Two-Sample T-Test\n\n**Activity: Conduct a two-sample t-test**\n\nNow we can compare the mean pine needle lengths between windward and leeward sides.\n\nH₀: μ₁ = μ₂ (The mean needle lengths are equal)\n\nH₁: μ₁ ≠ μ₂ (The mean needle lengths are different)\n\nDeciding between:\n\n-   Standard t-test (equal variances)\n-   Welch's t-test (unequal variances)\n\n# Based on our Levene's test result.\n\n\n\n\n\n\n::: {.cell exercise='true'}\n\n```{.r .cell-code}\n# YOUR TASK: Conduct a two-sample t-test\n# Use var.equal=TRUE for standard t-test or var.equal=FALSE for Welch's t-test\n\n# Standard t-test (if variances are equal)\nt_test_result <- t.test(length_mm ~ wind, data = pine_data, var.equal = TRUE)\nprint(\"Standard two-sample t-test:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Standard two-sample t-test:\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(t_test_result)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tTwo Sample t-test\n\ndata:  length_mm by wind\nt = 8.6792, df = 46, p-value = 3.01e-11\nalternative hypothesis: true difference in means between group lee and group wind is not equal to 0\n95 percent confidence interval:\n 4.224437 6.775563\nsample estimates:\n mean in group lee mean in group wind \n          20.41667           14.91667 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Calculate t-statistic manually (optional - uggg - maybe )\n# YOUR CODE HERE: t = (mean1 - mean2) / sqrt((s1^2/n1) + (s2^2/n2))\n```\n:::\n\n\n\n\n\n\n# **Part 2:** Interpreting and Reporting Two-Sample T-Test Results\n\n::::: columns\n::: {.column width=\"60%\"}\n**Activity: Interpret the results of the two-sample t-test**\n\nWhat can we conclude about the needle lengths on windward vs. leeward sides?\n\n**How to report this result in a scientific paper:**\n\n\"A two-tailed, two-sample t-test at α=0.05 showed \\[a significant/no significant\\] difference in needle length between windward (M = ..., SD = ...) and leeward (M = ..., SD = ...) sides of pine trees, t(...) = ..., p = ....\"\n:::\n\n::: {.column width=\"40%\"}\n![](images/clipboard-3575593369.png){width=\"350\"}\n:::\n:::::\n\n# What is Power\n\nStatistical power represents the probability of detecting a true effect (rejecting the null hypothesis when it is false). In this case, with a power of 97%, there's a 97% chance of detecting a true difference of 30 units between the means of the two groups if such a difference actually exists.\n\nA power analysis like this is typically done for one of these purposes:\n\n1.  Before data collection to determine required sample size\n2.  After a study to evaluate if the sample size was adequate\n3.  To determine the minimum detectable effect size with the given sample\n\nWith 97% power, this test has excellent ability to detect the specified effect size. Generally, **80% power is considered acceptable**, so 97% indicates a very well-powered study for detecting a difference of 30mm between the groups.\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlee_df <- pine_data %>% filter(wind == \"lee\")\nwind_df <- pine_data %>% filter(wind == \"wind\")\n# Calculate power for detecting a 1 mm difference\nwind_diff = 1\n\nlee_n <- nrow(lee_df)\nwind_n <- nrow(wind_df)\n\nwind_sd_pooled <- sqrt((var(lee_df$length_mm) * (lee_n-1) + \n                  var(wind_df$length_mm) * (wind_n-1)) / \n                  (lee_n + wind_n - 2))\n\n# Calculate power\nwind_effect_size <- wind_diff / wind_sd_pooled  # Cohen's d\nwind_df <- lee_n + wind_n - 2\nwind_alpha <- 0.05\nwind_power <- power.t.test(n = min(lee_n,wind_n), \n                     delta = wind_effect_size,\n                     sd = 1,  # Using standardized effect size\n                     sig.level = 0.5,\n                     type = \"two.sample\",\n                     alternative = \"two.sided\")\n\n# Display results\nwind_power\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n     Two-sample t test power calculation \n\n              n = 24\n          delta = 0.4555423\n             sd = 1\n      sig.level = 0.5\n          power = 0.8158402\n    alternative = two.sided\n\nNOTE: n is number in *each* group\n```\n\n\n:::\n:::\n\n\n\n\n\n\n# Now to make a final plot\n\nTypically we will make a plot that has the mean and standard error on it to represent the data\n\n## your Task is to make this plot\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npine_mean_se <- pine_data %>% \n  ggplot(aes(wind, length_mm, color = wind))+\n  stat_summary(fun = \"mean\", na.rm=TRUE, geom=\"point\", size = 3)+\n  stat_summary(fun.data = \"mean_se\", width = 0.2, geom = \"errorbar\")\n\npine_mean_se\n```\n\n::: {.cell-output-display}\n![](06_02_class_activity_files/figure-docx/unnamed-chunk-9-1.png)\n:::\n:::\n\n\n\n\n\n\n# **Summary and Conclusions**\n\nIn this activity, we've:\n\n1.  Formulated hypotheses about pine needle length\n2.  Tested assumptions for parametric tests\n3.  Conducted a two-sample t-tests\n4.  Visualized data using appropriate methods\n5.  Learned how to interpret and report t-test results\n\n**Key takeaways:**\n\n-   Always check assumptions before conducting tests\n-   Visualize your data to understand patterns\n-   Report results comprehensively\n-   Consider alternatives when assumptions are violated\n\n# Reflection Questions\n\nAfter completing the activities, discuss these questions with your group:\n\n1.  How does sample size affect our confidence in estimating the population mean?\n2.  Why is the t-distribution more appropriate than the normal distribution when working with small samples?\n3.  When comparing two populations, what can we learn from looking at confidence intervals versus performing a t-test?\n4.  How would you explain the concept of statistical significance to someone who has never taken a statistics course?\n5.  What do we do if assumptions FAIL!!!\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}